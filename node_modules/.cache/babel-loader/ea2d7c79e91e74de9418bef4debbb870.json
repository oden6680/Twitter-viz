{"ast":null,"code":"import * as d3 from \"d3\";\nimport * as topojson from \"topojson\";\nexport default function ChoroplethMap() {\n  const width = 400; // 描画サイズ: 幅\n\n  const height = 400; // 描画サイズ: 高さ\n\n  const centerPos = [137.0, 38.2]; // 地図のセンター位置\n\n  const scale = 1000; // 地図のスケール\n  // 地図の投影設定\n\n  const projection = d3.geoMercator().center(centerPos).translate([width / 2, height / 2]).scale(scale); // 地図をpathに投影(変換)\n\n  const path = d3.geoPath().projection(projection); // SVG要素を追加\n\n  const svg = d3.select(`#map-container`).append(`svg`).attr(`viewBox`, `0 0 ${width} ${height}`).attr(`width`, `100%`).attr(`height`, `100%`); // \n  // [ メモ ]\n  // 動的にGeoJsonファイルを読み込む場合は以下のコードを使用\n  // const geoJson = await d3.json(`/japan.geo.json`);\n  // \n  // 都道府県の領域データをpathで描画\n\n  svg.selectAll(`path`).data(topojson.features).enter().append(`path`).attr(`d`, path).attr(`stroke`, `#666`).attr(`stroke-width`, 0.25).attr(`fill`, `#2566CC`).attr(`fill-opacity`, () => {\n    // メモ\n    // item.properties.name_ja に都道府県名が入っている\n    // 透明度をランダムに指定する (0.0 - 1.0)\n    return Math.random();\n  })\n  /**\n   * 都道府県領域の MouseOver イベントハンドラ\n   */\n  .on(`mouseover`, function () {\n    // ラベル用のグループ\n    const group = svg.append(`g`).attr(`id`, `label-group`); // 地図データから都道府県名を取得する\n\n    const label = item.properties.name_ja; // 矩形を追加: テキストの枠\n\n    const rectElement = group.append(`rect`).attr(`id`, `label-rect`).attr(`stroke`, `#666`).attr(`stroke-width`, 0.5).attr(`fill`, `#fff`); // テキストを追加\n\n    const textElement = group.append(`text`).attr(`id`, `label-text`).text(label); // テキストのサイズから矩形のサイズを調整\n\n    const padding = {\n      x: 5,\n      y: 0\n    };\n    const textSize = textElement.node().getBBox();\n    rectElement.attr(`x`, textSize.x - padding.x).attr(`y`, textSize.y - padding.y).attr(`width`, textSize.width + padding.x * 2).attr(`height`, textSize.height + padding.y * 2);\n  });\n}\n_c = ChoroplethMap;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChoroplethMap\");","map":{"version":3,"sources":["/Users/oda/Documents/development/Twitter-viz/src/components/ChoroplethMap/index.js"],"names":["d3","topojson","ChoroplethMap","width","height","centerPos","scale","projection","geoMercator","center","translate","path","geoPath","svg","select","append","attr","selectAll","data","features","enter","Math","random","on","group","label","item","properties","name_ja","rectElement","textElement","text","padding","x","y","textSize","node","getBBox"],"mappings":"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","sourcesContent":["import * as d3 from \"d3\";\nimport * as topojson from \"topojson\";\n\nexport default function ChoroplethMap() {\n\n  const width = 400; // 描画サイズ: 幅\n  const height = 400; // 描画サイズ: 高さ\n  const centerPos = [137.0, 38.2]; // 地図のセンター位置\n  const scale = 1000; // 地図のスケール\n\n  // 地図の投影設定\n  const projection = d3\n    .geoMercator()\n    .center(centerPos)\n    .translate([width / 2, height / 2])\n    .scale(scale);\n\n  // 地図をpathに投影(変換)\n  const path = d3.geoPath().projection(projection);\n\n  // SVG要素を追加\n  const svg = d3\n    .select(`#map-container`)\n    .append(`svg`)\n    .attr(`viewBox`, `0 0 ${width} ${height}`)\n    .attr(`width`, `100%`)\n    .attr(`height`, `100%`);\n\n  // \n  // [ メモ ]\n  // 動的にGeoJsonファイルを読み込む場合は以下のコードを使用\n  // const geoJson = await d3.json(`/japan.geo.json`);\n  // \n\n  // 都道府県の領域データをpathで描画\n  svg\n    .selectAll(`path`)\n    .data(topojson.features)\n    .enter()\n    .append(`path`)\n    .attr(`d`, path)\n    .attr(`stroke`, `#666`)\n    .attr(`stroke-width`, 0.25)\n    .attr(`fill`, `#2566CC`)\n    .attr(`fill-opacity`, () => {\n      // メモ\n      // item.properties.name_ja に都道府県名が入っている\n\n      // 透明度をランダムに指定する (0.0 - 1.0)\n      return Math.random();\n    })\n\n    /**\n     * 都道府県領域の MouseOver イベントハンドラ\n     */\n    .on(`mouseover`, function() {\n      // ラベル用のグループ\n      const group = svg.append(`g`).attr(`id`, `label-group`);\n\n      // 地図データから都道府県名を取得する\n      const label = item.properties.name_ja;\n\n      // 矩形を追加: テキストの枠\n      const rectElement = group\n        .append(`rect`)\n        .attr(`id`, `label-rect`)\n        .attr(`stroke`, `#666`)\n        .attr(`stroke-width`, 0.5)\n        .attr(`fill`, `#fff`);\n\n      // テキストを追加\n      const textElement = group\n        .append(`text`)\n        .attr(`id`, `label-text`)\n        .text(label);\n\n      // テキストのサイズから矩形のサイズを調整\n      const padding = { x: 5, y: 0 };\n      const textSize = textElement.node().getBBox();\n      rectElement\n        .attr(`x`, textSize.x - padding.x)\n        .attr(`y`, textSize.y - padding.y)\n        .attr(`width`, textSize.width + padding.x * 2)\n        .attr(`height`, textSize.height + padding.y * 2);\n    })\n}"]},"metadata":{},"sourceType":"module"}